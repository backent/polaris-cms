import{V as ve}from"./vue-draggable-next.esm-bundler.9da7018c.js";import{d as fe,i as M,r as p,x as pe,E as he,k as ge,o as Ve,b as s,e as v,f as B,w as a,j as w,t as P,u as h,y as ye,g as l,l as x,F as T,m as G,h as c,s as be,v as ke,p as we}from"./index.b5a147f6.js";const y=g=>(be("data-v-a8625c62"),g=g(),ke(),g),xe=y(()=>c("h3",null,"Details",-1)),Ue=y(()=>c("h3",null,"Dimension",-1)),Ce=y(()=>c("h3",null,"Seat",-1)),Fe=y(()=>c("h3",null,"Features",-1)),Ne={class:"feature-container"},Se=["for"],Me=["src"],Be={class:"feature-name"},De=["index"],je={class:"tooltip"},Ie=["src"],$e=["src"],Ee={key:1,class:"lds-facebook"},Ke=y(()=>c("div",null,null,-1)),ze=y(()=>c("div",null,null,-1)),Le=y(()=>c("div",null,null,-1)),Pe=[Ke,ze,Le],qe=fe({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(g,{emit:J}){const b=g,D=M("categoriesAPI"),f=M("productsAPI"),j=M("tempMediaAPI"),I=M("featuresAPI"),Q="https://polarisfurniture.id",$=p(!1),E=p(!1),q=p(null),H=p(null),C=p();let K=[],z=[];const m=p({name:[t=>!!t||"Name is required!"],category_id:[t=>!!t||"Category is required!"],code:[],id_description:[],en_description:[],features:[],premium_material:[],dimension_height:[],dimension_length:[],dimension_width:[],seat_width:[],seat_height:[],seat_length:[]}),R={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[],order:[],feature_ids:[]},o=p({...R}),_=p([]);p([]);function O(){J("close"),$.value=!1}async function W(){var t;return(t=H.value)==null?void 0:t.validate()}async function X(){const t=await W();if(!(t!=null&&t.valid))return;let e;const u={...o.value,files:o.value.files.map(r=>r.id),order:oe()};return E.value=!0,b.mode==="create"?e=f==null?void 0:f.post(u):e=f==null?void 0:f.put(o.value.id,u),e==null?void 0:e.then(()=>{O()}).catch(r=>{throw r}).finally(()=>{E.value=!1})}pe(o,W,{deep:!0}),he(()=>{var t,e;o.value.category_id=(e=(t=C.value)==null?void 0:t.id)!=null?e:0});const F=ge(()=>{const t={variant:void 0,icon:void 0,size:void 0,color:"primary"},e={variant:"plain",icon:b.icon,size:"x-small",color:b.colorButton};return b.mode==="create"?t:e});Ve(()=>{D==null||D.get().then(t=>{K=t.data}),I==null||I.get().then(t=>{z=t.data})});function Y(){o.value={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[],order:[],feature_ids:[]},_.value=[]}async function Z(){Y(),b.mode!=="create"&&(f==null||f.show(b.id).then(t=>{const{images:e,...u}=t.data;o.value={...R,...u},C.value=K.find(r=>r.id===o.value.category_id),te(e)}))}function A(){var t;(t=q.value)==null||t.click()}async function ee(t){const e=t.target.files,u=[];for(let r=0;r<e.length;r++){const i=e.item(r),d=new FormData;d.append("file",i),u.push(j==null?void 0:j.post(d))}await Promise.all(u).then(r=>{o.value.files=[...o.value.files,...r.reduce((i,d,U)=>(i.push({id:d.data,file:e.item(U)}),i),[])]}).then(()=>{_.value=[..._.value,...t.target.files]})}function le(t){try{t.id?(o.value.removedFiles=[...o.value.removedFiles,t.id],_.value=_.value.filter(e=>{var u;return((u=e==null?void 0:e.id)!=null?u:0)!==t.id})):(_.value=_.value.filter(e=>e!==t),o.value.files=o.value.files.filter(e=>e.file!==t))}catch(e){throw console.log("Error while deleting file"),e}}function k(t){const e=["0","1","2","3","4","5","6","7","8","9","."],u=t.key;e.includes(u)||t.preventDefault()}function te(t){_.value=t.map(e=>({...e,name:e.original_name}))}function oe(){return _.value.reduce((e,u,r)=>{const i=!u.id,d=r+1;return i?e.push({newImage:!0,order:d,id:o.value.files.find(U=>U.file===u).id}):e.push({newImage:!1,order:d,id:u.id}),e},[])}function ne(t){return URL.createObjectURL(t)}return(t,e)=>{const u=s("v-icon"),r=s("v-card-title"),i=s("v-col"),d=s("v-text-field"),U=s("v-autocomplete"),V=s("v-row"),N=s("v-textarea"),ae=s("v-checkbox"),S=s("v-btn"),ie=s("v-chip"),ue=s("v-container"),se=s("v-form"),de=s("v-card-text"),re=s("v-spacer"),me=s("v-card-actions"),ce=s("v-card"),_e=s("v-dialog");return v(),B(S,{variant:h(F).variant,size:h(F).size,color:h(F).color,onClick:Z},{default:a(()=>[w(P(g.mode==="create"?"Add New":"")+" ",1),g.mode!=="create"?(v(),B(u,{key:0,icon:h(F).icon},null,8,["icon"])):ye("",!0),l(_e,{modelValue:$.value,"onUpdate:modelValue":e[15]||(e[15]=n=>$.value=n),activator:"parent","max-width":"800"},{default:a(()=>[l(ce,null,{default:a(()=>[l(r,null,{default:a(()=>[w(" Form ")]),_:1}),l(de,null,{default:a(()=>[l(se,{ref_key:"formProduct",ref:H},{default:a(()=>[l(ue,null,{default:a(()=>[l(V,null,{default:a(()=>[l(i,{md:"12"},{default:a(()=>[xe]),_:1}),l(i,{md:"6"},{default:a(()=>[l(d,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.name=n),rules:m.value.name,label:"Product Name"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"6"},{default:a(()=>[l(U,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=n=>C.value=n),rules:m.value.category_id,items:h(K),label:"Category","item-title":"name","return-object":""},null,8,["modelValue","rules","items"])]),_:1}),l(i,{md:"6"},{default:a(()=>[l(d,{modelValue:o.value.code,"onUpdate:modelValue":e[2]||(e[2]=n=>o.value.code=n),rules:m.value.code,label:"Code"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(i,{md:"12"},{default:a(()=>[l(N,{modelValue:o.value.en_description,"onUpdate:modelValue":e[3]||(e[3]=n=>o.value.en_description=n),rules:m.value.en_description,label:"Description (English)",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:a(()=>[l(N,{modelValue:o.value.id_description,"onUpdate:modelValue":e[4]||(e[4]=n=>o.value.id_description=n),rules:m.value.id_description,label:"Description (Bahasa)",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(i,{md:"12"},{default:a(()=>[l(N,{modelValue:o.value.features,"onUpdate:modelValue":e[5]||(e[5]=n=>o.value.features=n),rules:m.value.features,label:"Features",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:a(()=>[l(N,{modelValue:o.value.premium_material,"onUpdate:modelValue":e[6]||(e[6]=n=>o.value.premium_material=n),rules:m.value.premium_material,label:"Premium Material",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(i,{md:"12"},{default:a(()=>[Ue]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.dimension_width,"onUpdate:modelValue":e[7]||(e[7]=n=>o.value.dimension_width=n),modelModifiers:{number:!0},rules:m.value.dimension_width,onKeypress:k,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.dimension_length,"onUpdate:modelValue":e[8]||(e[8]=n=>o.value.dimension_length=n),modelModifiers:{number:!0},rules:m.value.dimension_length,onKeypress:k,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.dimension_height,"onUpdate:modelValue":e[9]||(e[9]=n=>o.value.dimension_height=n),modelModifiers:{number:!0},rules:m.value.dimension_height,onKeypress:k,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:a(()=>[l(i,{md:"12"},{default:a(()=>[Ce]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.seat_width,"onUpdate:modelValue":e[10]||(e[10]=n=>o.value.seat_width=n),modelModifiers:{number:!0},rules:m.value.seat_width,onKeypress:k,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.seat_length,"onUpdate:modelValue":e[11]||(e[11]=n=>o.value.seat_length=n),modelModifiers:{number:!0},rules:m.value.seat_length,onKeypress:k,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:a(()=>[l(d,{modelValue:o.value.seat_height,"onUpdate:modelValue":e[12]||(e[12]=n=>o.value.seat_height=n),modelModifiers:{number:!0},rules:m.value.seat_height,onKeypress:k,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,{class:"d-flex justify-center"},{default:a(()=>[l(i,{md:"12"},{default:a(()=>[Fe]),_:1}),(v(!0),x(T,null,G(h(z),n=>(v(),B(i,{md:Math.floor(12/h(z).length),key:n.id},{default:a(()=>[c("div",Ne,[c("label",{for:`feature-${n.id}`},[c("img",{src:n.link},null,8,Me)],8,Se),l(ae,{id:`feature-${n.id}`,modelValue:o.value.feature_ids,"onUpdate:modelValue":e[13]||(e[13]=L=>o.value.feature_ids=L),value:n.id,class:"checkbox"},null,8,["id","modelValue","value"]),c("div",Be,P(n.name),1)])]),_:2},1032,["md"]))),128))]),_:1}),l(V,null,{default:a(()=>[l(i,{md:"3",style:{height:"40px"}},{default:a(()=>[l(S,{onClick:e[14]||(e[14]=n=>A())},{default:a(()=>[w(" Add Image ")]),_:1}),c("input",{ref_key:"file",ref:q,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:ee},null,544)]),_:1}),l(i,{md:"12",class:"files"},{default:a(()=>[l(h(ve),{list:_.value},{default:a(()=>[(v(!0),x(T,null,G(_.value,(n,L)=>(v(),x("div",{index:L,class:"chip-container"},[l(ie,{"prepend-icon":"mdi-file-image"},{default:a(()=>[w(P(t.$ellipsis(n.name,20))+" ",1),l(u,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:He=>le(n)},null,8,["onClick"])]),_:2},1024),c("div",je,[n.link?(v(),x("img",{key:0,src:`${h(Q)}${n.link}`},null,8,Ie)):(v(),x("img",{key:1,src:ne(n)},null,8,$e))])],8,De))),256))]),_:1},8,["list"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),l(me,{class:"footer-form"},{default:a(()=>[l(re),E.value?(v(),x("div",Ee,Pe)):(v(),B(S,{key:0,color:"primary",onClick:X},{default:a(()=>[w("Save")]),_:1})),l(S,{color:"orange",onClick:O},{default:a(()=>[w("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const We=we(qe,[["__scopeId","data-v-a8625c62"]]);export{We as default};
