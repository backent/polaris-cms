import{d as ie,i as j,r as v,l as ue,B as de,k as se,o as re,b as u,e as y,f as z,w as n,j as b,t as E,u as k,C as me,g as l,h as f,m as P,F as ce,n as _e,v as ve,x as fe,q as pe}from"./index.c30b73a3.js";const w=p=>(ve("data-v-6e3cd946"),p=p(),fe(),p),ge=w(()=>f("h3",null,"Details",-1)),he=w(()=>f("h3",null,"Dimension",-1)),Ve=w(()=>f("h3",null,"Seat",-1)),ye=["index"],be={class:"tooltip"},we={key:1,class:"lds-facebook"},ke=w(()=>f("div",null,null,-1)),xe=w(()=>f("div",null,null,-1)),Ce=w(()=>f("div",null,null,-1)),Fe=[ke,xe,Ce],Ue=ie({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(p,{emit:W}){const g=p,S=j("categoriesAPI"),c=j("productsAPI"),B=j("tempMediaAPI"),N=v(!1),M=v(!1),q=v(null),I=v(null),x=v();let D=[];const s=v({name:[o=>!!o||"Name is required!"],category_id:[o=>!!o||"Category is required!"],code:[],id_description:[],en_description:[],features:[],premium_material:[],dimension_height:[],dimension_length:[],dimension_width:[],seat_width:[],seat_height:[],seat_length:[]}),L={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[]},t=v({...L}),_=v([]);function $(){W("close"),N.value=!1}async function H(){var o;return(o=I.value)==null?void 0:o.validate()}async function T(){const o=await H();if(!(o!=null&&o.valid))return;let e;const d={...t.value,files:t.value.files.map(r=>r.id)};return M.value=!0,g.mode==="create"?e=c==null?void 0:c.post(d):e=c==null?void 0:c.put(t.value.id,d),e==null?void 0:e.then(()=>{$()}).catch(r=>{throw r}).finally(()=>{M.value=!1})}ue(t,H,{deep:!0}),de(()=>{var o,e;t.value.category_id=(e=(o=x.value)==null?void 0:o.id)!=null?e:0});const C=se(()=>{const o={variant:void 0,icon:void 0,size:void 0,color:"primary"},e={variant:"plain",icon:g.icon,size:"x-small",color:g.colorButton};return g.mode==="create"?o:e});re(()=>{S==null||S.get().then(o=>{D=o.data})});function G(){t.value={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[]},_.value=[]}async function J(){G(),g.mode!=="create"&&(c==null||c.show(g.id).then(o=>{const{images:e,...d}=o.data;t.value={...L,...d},x.value=D.find(r=>r.id===t.value.category_id),X(e)}))}function O(){var o;(o=q.value)==null||o.click()}async function Q(o){const e=o.target.files,d=[];for(let r=0;r<e.length;r++){const i=e.item(r),m=new FormData;m.append("file",i),d.push(B==null?void 0:B.post(m))}await Promise.all(d).then(r=>{t.value.files=[...t.value.files,...r.reduce((i,m,K)=>(i.push({id:m.data,file:e.item(K)}),i),[])]}),_.value=[..._.value,...o.target.files]}function R(o){try{o.id?(t.value.removedFiles=[...t.value.removedFiles,o.id],_.value=_.value.filter(e=>{var d;return((d=e==null?void 0:e.id)!=null?d:0)!==o.id})):(_.value=_.value.filter(e=>e!==o),t.value.files=t.value.files.filter(e=>e.file!==o))}catch(e){throw console.log("Error while deleting file"),e}}function h(o){const e=["0","1","2","3","4","5","6","7","8","9","."],d=o.key;e.includes(d)||o.preventDefault()}function X(o){_.value=o.map(e=>({...e,name:e.original_name}))}return(o,e)=>{const d=u("v-icon"),r=u("v-card-title"),i=u("v-col"),m=u("v-text-field"),K=u("v-autocomplete"),V=u("v-row"),F=u("v-textarea"),U=u("v-btn"),Y=u("v-chip"),Z=u("v-container"),A=u("v-form"),ee=u("v-card-text"),le=u("v-spacer"),te=u("v-card-actions"),oe=u("v-card"),ne=u("v-dialog");return y(),z(U,{variant:k(C).variant,size:k(C).size,color:k(C).color,onClick:J},{default:n(()=>[b(E(p.mode==="create"?"Add New":"")+" ",1),p.mode!=="create"?(y(),z(d,{key:0,icon:k(C).icon},null,8,["icon"])):me("",!0),l(ne,{modelValue:N.value,"onUpdate:modelValue":e[14]||(e[14]=a=>N.value=a),activator:"parent","max-width":"800"},{default:n(()=>[l(oe,null,{default:n(()=>[l(r,null,{default:n(()=>[b(" Form ")]),_:1}),l(ee,null,{default:n(()=>[l(A,{ref_key:"formProduct",ref:I},{default:n(()=>[l(Z,null,{default:n(()=>[l(V,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[ge]),_:1}),l(i,{md:"6"},{default:n(()=>[l(m,{modelValue:t.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.name=a),rules:s.value.name,label:"Product Name"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"6"},{default:n(()=>[l(K,{modelValue:x.value,"onUpdate:modelValue":e[1]||(e[1]=a=>x.value=a),rules:s.value.category_id,items:k(D),label:"Category","item-title":"name","return-object":""},null,8,["modelValue","rules","items"])]),_:1}),l(i,{md:"6"},{default:n(()=>[l(m,{modelValue:t.value.code,"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.code=a),rules:s.value.code,label:"Code"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[l(F,{modelValue:t.value.en_description,"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.en_description=a),rules:s.value.en_description,label:"Description (English)",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:n(()=>[l(F,{modelValue:t.value.id_description,"onUpdate:modelValue":e[4]||(e[4]=a=>t.value.id_description=a),rules:s.value.id_description,label:"Description (Bahasa)",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[l(F,{modelValue:t.value.features,"onUpdate:modelValue":e[5]||(e[5]=a=>t.value.features=a),rules:s.value.features,label:"Features",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:n(()=>[l(F,{modelValue:t.value.premium_material,"onUpdate:modelValue":e[6]||(e[6]=a=>t.value.premium_material=a),rules:s.value.premium_material,label:"Premium Material",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[he]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.dimension_width,"onUpdate:modelValue":e[7]||(e[7]=a=>t.value.dimension_width=a),modelModifiers:{number:!0},rules:s.value.dimension_width,onKeypress:h,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.dimension_length,"onUpdate:modelValue":e[8]||(e[8]=a=>t.value.dimension_length=a),modelModifiers:{number:!0},rules:s.value.dimension_length,onKeypress:h,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.dimension_height,"onUpdate:modelValue":e[9]||(e[9]=a=>t.value.dimension_height=a),modelModifiers:{number:!0},rules:s.value.dimension_height,onKeypress:h,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[Ve]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.seat_width,"onUpdate:modelValue":e[10]||(e[10]=a=>t.value.seat_width=a),modelModifiers:{number:!0},rules:s.value.seat_width,onKeypress:h,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.seat_length,"onUpdate:modelValue":e[11]||(e[11]=a=>t.value.seat_length=a),modelModifiers:{number:!0},rules:s.value.seat_length,onKeypress:h,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(m,{modelValue:t.value.seat_height,"onUpdate:modelValue":e[12]||(e[12]=a=>t.value.seat_height=a),modelModifiers:{number:!0},rules:s.value.seat_height,onKeypress:h,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(V,null,{default:n(()=>[l(i,{md:"3",style:{height:"40px"}},{default:n(()=>[l(U,{onClick:e[13]||(e[13]=a=>O())},{default:n(()=>[b(" Add Image ")]),_:1}),f("input",{ref_key:"file",ref:q,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:Q},null,544)]),_:1}),l(i,{md:"12",class:"files"},{default:n(()=>[(y(!0),P(ce,null,_e(_.value,(a,ae)=>(y(),P("div",{index:ae,class:"chip-container"},[l(Y,{"prepend-icon":"mdi-file-image"},{default:n(()=>[b(E(o.$ellipsis(a.name,20))+" ",1),l(d,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:Se=>R(a)},null,8,["onClick"])]),_:2},1024),f("div",be,E(a.name),1)],8,ye))),256))]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),l(te,{class:"footer-form"},{default:n(()=>[l(le),M.value?(y(),P("div",we,Fe)):(y(),z(U,{key:0,color:"primary",onClick:T},{default:n(()=>[b("Save")]),_:1})),l(U,{color:"orange",onClick:$},{default:n(()=>[b("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const Ne=pe(Ue,[["__scopeId","data-v-6e3cd946"]]);export{Ne as default};
