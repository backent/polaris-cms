import{V as se}from"./vue-draggable-next.esm-bundler.dacac5ed.js";import{d as re,i as K,r as v,l as me,B as ce,k as _e,o as ve,b as s,e as f,f as q,w as n,j as w,t as H,u as h,C as fe,g as l,h as p,m as x,F as pe,n as ge,v as he,x as Ve,q as ye}from"./index.3417068f.js";const k=g=>(he("data-v-e2a80fa1"),g=g(),Ve(),g),be=k(()=>p("h3",null,"Details",-1)),we=k(()=>p("h3",null,"Dimension",-1)),ke=k(()=>p("h3",null,"Seat",-1)),Ce=["index"],xe={class:"tooltip"},Ue=["src"],Fe=["src"],Ne={key:1,class:"lds-facebook"},Se=k(()=>p("div",null,null,-1)),Be=k(()=>p("div",null,null,-1)),De=k(()=>p("div",null,null,-1)),Me=[Se,Be,De],Ie=re({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(g,{emit:R}){const V=g,B=K("categoriesAPI"),_=K("productsAPI"),D=K("tempMediaAPI"),O="https://polarisfurniture.id",M=v(!1),I=v(!1),z=v(null),E=v(null),U=v();let j=[];const m=v({name:[t=>!!t||"Name is required!"],category_id:[t=>!!t||"Category is required!"],code:[],id_description:[],en_description:[],features:[],premium_material:[],dimension_height:[],dimension_length:[],dimension_width:[],seat_width:[],seat_height:[],seat_length:[]}),L={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[],order:[]},o=v({...L}),c=v([]);function P(){R("close"),M.value=!1}async function $(){var t;return(t=E.value)==null?void 0:t.validate()}async function W(){const t=await $();if(!(t!=null&&t.valid))return;let e;const u={...o.value,files:o.value.files.map(r=>r.id),order:Z()};return I.value=!0,V.mode==="create"?e=_==null?void 0:_.post(u):e=_==null?void 0:_.put(o.value.id,u),e==null?void 0:e.then(()=>{P()}).catch(r=>{throw r}).finally(()=>{I.value=!1})}me(o,$,{deep:!0}),ce(()=>{var t,e;o.value.category_id=(e=(t=U.value)==null?void 0:t.id)!=null?e:0});const F=_e(()=>{const t={variant:void 0,icon:void 0,size:void 0,color:"primary"},e={variant:"plain",icon:V.icon,size:"x-small",color:V.colorButton};return V.mode==="create"?t:e});ve(()=>{B==null||B.get().then(t=>{j=t.data})});function T(){o.value={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],removedFiles:[],order:[]},c.value=[]}async function G(){T(),V.mode!=="create"&&(_==null||_.show(V.id).then(t=>{const{images:e,...u}=t.data;o.value={...L,...u},U.value=j.find(r=>r.id===o.value.category_id),Y(e)}))}function J(){var t;(t=z.value)==null||t.click()}async function Q(t){const e=t.target.files,u=[];for(let r=0;r<e.length;r++){const i=e.item(r),d=new FormData;d.append("file",i),u.push(D==null?void 0:D.post(d))}await Promise.all(u).then(r=>{o.value.files=[...o.value.files,...r.reduce((i,d,C)=>(i.push({id:d.data,file:e.item(C)}),i),[])]}).then(()=>{c.value=[...c.value,...t.target.files]})}function X(t){try{t.id?(o.value.removedFiles=[...o.value.removedFiles,t.id],c.value=c.value.filter(e=>{var u;return((u=e==null?void 0:e.id)!=null?u:0)!==t.id})):(c.value=c.value.filter(e=>e!==t),o.value.files=o.value.files.filter(e=>e.file!==t))}catch(e){throw console.log("Error while deleting file"),e}}function y(t){const e=["0","1","2","3","4","5","6","7","8","9","."],u=t.key;e.includes(u)||t.preventDefault()}function Y(t){c.value=t.map(e=>({...e,name:e.original_name}))}function Z(){return c.value.reduce((e,u,r)=>{const i=!u.id,d=r+1;return i?e.push({newImage:!0,order:d,id:o.value.files.find(C=>C.file===u).id}):e.push({newImage:!1,order:d,id:u.id}),e},[])}function A(t){return URL.createObjectURL(t)}return(t,e)=>{const u=s("v-icon"),r=s("v-card-title"),i=s("v-col"),d=s("v-text-field"),C=s("v-autocomplete"),b=s("v-row"),N=s("v-textarea"),S=s("v-btn"),ee=s("v-chip"),le=s("v-container"),te=s("v-form"),oe=s("v-card-text"),ne=s("v-spacer"),ae=s("v-card-actions"),ie=s("v-card"),ue=s("v-dialog");return f(),q(S,{variant:h(F).variant,size:h(F).size,color:h(F).color,onClick:G},{default:n(()=>[w(H(g.mode==="create"?"Add New":"")+" ",1),g.mode!=="create"?(f(),q(u,{key:0,icon:h(F).icon},null,8,["icon"])):fe("",!0),l(ue,{modelValue:M.value,"onUpdate:modelValue":e[14]||(e[14]=a=>M.value=a),activator:"parent","max-width":"800"},{default:n(()=>[l(ie,null,{default:n(()=>[l(r,null,{default:n(()=>[w(" Form ")]),_:1}),l(oe,null,{default:n(()=>[l(te,{ref_key:"formProduct",ref:E},{default:n(()=>[l(le,null,{default:n(()=>[l(b,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[be]),_:1}),l(i,{md:"6"},{default:n(()=>[l(d,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.name=a),rules:m.value.name,label:"Product Name"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"6"},{default:n(()=>[l(C,{modelValue:U.value,"onUpdate:modelValue":e[1]||(e[1]=a=>U.value=a),rules:m.value.category_id,items:h(j),label:"Category","item-title":"name","return-object":""},null,8,["modelValue","rules","items"])]),_:1}),l(i,{md:"6"},{default:n(()=>[l(d,{modelValue:o.value.code,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.code=a),rules:m.value.code,label:"Code"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(b,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[l(N,{modelValue:o.value.en_description,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.en_description=a),rules:m.value.en_description,label:"Description (English)",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:n(()=>[l(N,{modelValue:o.value.id_description,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.id_description=a),rules:m.value.id_description,label:"Description (Bahasa)",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(b,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[l(N,{modelValue:o.value.features,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.features=a),rules:m.value.features,label:"Features",counter:""},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"12"},{default:n(()=>[l(N,{modelValue:o.value.premium_material,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.premium_material=a),rules:m.value.premium_material,label:"Premium Material",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(b,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[we]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.dimension_width,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.dimension_width=a),modelModifiers:{number:!0},rules:m.value.dimension_width,onKeypress:y,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.dimension_length,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.dimension_length=a),modelModifiers:{number:!0},rules:m.value.dimension_length,onKeypress:y,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.dimension_height,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.dimension_height=a),modelModifiers:{number:!0},rules:m.value.dimension_height,onKeypress:y,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(b,null,{default:n(()=>[l(i,{md:"12"},{default:n(()=>[ke]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.seat_width,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.seat_width=a),modelModifiers:{number:!0},rules:m.value.seat_width,onKeypress:y,label:"Width"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.seat_length,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.seat_length=a),modelModifiers:{number:!0},rules:m.value.seat_length,onKeypress:y,label:"Length"},null,8,["modelValue","rules"])]),_:1}),l(i,{md:"4"},{default:n(()=>[l(d,{modelValue:o.value.seat_height,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.seat_height=a),modelModifiers:{number:!0},rules:m.value.seat_height,onKeypress:y,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(b,null,{default:n(()=>[l(i,{md:"3",style:{height:"40px"}},{default:n(()=>[l(S,{onClick:e[13]||(e[13]=a=>J())},{default:n(()=>[w(" Add Image ")]),_:1}),p("input",{ref_key:"file",ref:z,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:Q},null,544)]),_:1}),l(i,{md:"12",class:"files"},{default:n(()=>[l(h(se),{list:c.value,onChange:t.debug},{default:n(()=>[(f(!0),x(pe,null,ge(c.value,(a,de)=>(f(),x("div",{index:de,class:"chip-container"},[l(ee,{"prepend-icon":"mdi-file-image"},{default:n(()=>[w(H(t.$ellipsis(a.name,20))+" ",1),l(u,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:je=>X(a)},null,8,["onClick"])]),_:2},1024),p("div",xe,[a.link?(f(),x("img",{key:0,src:`${h(O)}${a.link}`},null,8,Ue)):(f(),x("img",{key:1,src:A(a)},null,8,Fe))])],8,Ce))),256))]),_:1},8,["list","onChange"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),l(ae,{class:"footer-form"},{default:n(()=>[l(ne),I.value?(f(),x("div",Ne,Me)):(f(),q(S,{key:0,color:"primary",onClick:W},{default:n(()=>[w("Save")]),_:1})),l(S,{color:"orange",onClick:P},{default:n(()=>[w("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const ze=ye(Ie,[["__scopeId","data-v-e2a80fa1"]]);export{ze as default};
