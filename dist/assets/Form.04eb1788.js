import{V as te}from"./vue-draggable-next.esm-bundler.46376fd2.js";import{d as be,i as j,r as g,x as ke,E as we,k as xe,o as He,b as r,e as c,f as D,w as o,j as w,t as B,u as v,y as Fe,g as t,l as y,F as R,m as O,h as m,s as Ce,v as Ue,p as $e}from"./index.b37b3398.js";const b=x=>(Ce("data-v-fdae73bd"),x=x(),Ue(),x),Ie=b(()=>m("h3",null,"Details",-1)),Ne=b(()=>m("h3",null,"Dimension",-1)),Se=b(()=>m("h3",null,"Seat",-1)),je=b(()=>m("h3",null,"Features",-1)),De={class:"feature-container"},Be=["for"],Ee=["src"],Ke={class:"feature-name"},Me=b(()=>m("h3",null,"Image Header",-1)),qe=["index"],ze={class:"tooltip"},Le=["src"],Pe=["src"],Re=b(()=>m("h3",null,"Image Product",-1)),Oe=["index"],We={class:"tooltip"},Te=["src"],Ge=["src"],Je={key:1,class:"lds-facebook"},Qe=b(()=>m("div",null,null,-1)),Xe=b(()=>m("div",null,null,-1)),Ye=b(()=>m("div",null,null,-1)),Ze=[Qe,Xe,Ye],Ae=be({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(x,{emit:ae}){const F=x,E=j("categoriesAPI"),V=j("productsAPI"),C=j("tempMediaAPI"),K=j("featuresAPI"),M="https://polarisfurniture.id",q=g(!1),z=g(!1),W=g(null),T=g(null),G=g(null),N=g();let L=[],J=[];const _=g({name:[l=>!!l||"Name is required!"],category_id:[l=>!!l||"Category is required!"],code:[],id_description:[],en_description:[],features:[],premium_material:[],dimension_height:[],dimension_length:[],dimension_width:[],seat_width:[],seat_height:[],seat_length:[]}),Q={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],filesHeader:[],removedFiles:[],removedFilesHeader:[],order:[],feature_ids:[]},a=g({...Q}),f=g([]),p=g([]);function X(){ae("close"),q.value=!1}async function Y(){var l;return(l=G.value)==null?void 0:l.validate()}async function ne(){const l=await Y();if(!(l!=null&&l.valid))return;let e;const d={...a.value,files:a.value.files.map(s=>s.id),filesHeader:a.value.filesHeader.map(s=>s.id),order:A(),orderHeader:A("header")};return z.value=!0,F.mode==="create"?e=V==null?void 0:V.post(d):e=V==null?void 0:V.put(a.value.id,d),e==null?void 0:e.then(()=>{X()}).catch(s=>{throw s}).finally(()=>{z.value=!1})}ke(a,Y,{deep:!0}),we(()=>{var l,e;a.value.category_id=(e=(l=N.value)==null?void 0:l.id)!=null?e:0});const S=xe(()=>{const l={variant:void 0,icon:void 0,size:void 0,color:"primary"},e={variant:"plain",icon:F.icon,size:"x-small",color:F.colorButton};return F.mode==="create"?l:e});He(()=>{E==null||E.get().then(l=>{L=l.data}),K==null||K.get().then(l=>{J=l.data})});function oe(){a.value={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],filesHeader:[],removedFiles:[],removedFilesHeader:[],order:[],feature_ids:[]},f.value=[]}async function ie(){oe(),F.mode!=="create"&&(V==null||V.show(F.id).then(l=>{const{images:e,images_header:d,...s}=l.data;a.value={...Q,...s},N.value=L.find(i=>i.id===a.value.category_id),Z(e),Z(d,"header")}))}function de(){var l;(l=W.value)==null||l.click()}async function se(l){const e=l.target.files,d=[];for(let s=0;s<e.length;s++){const i=e.item(s),u=new FormData;u.append("file",i),d.push(C==null?void 0:C.post(u))}await Promise.all(d).then(s=>{a.value.files=[...a.value.files,...s.reduce((i,u,H)=>(i.push({id:u.data,file:e.item(H)}),i),[])]}).then(()=>{f.value=[...f.value,...l.target.files]})}function ue(l){try{l.id?(a.value.removedFiles=[...a.value.removedFiles,l.id],f.value=f.value.filter(e=>{var d;return((d=e==null?void 0:e.id)!=null?d:0)!==l.id})):(f.value=f.value.filter(e=>e!==l),a.value.files=a.value.files.filter(e=>e.file!==l))}catch(e){throw console.log("Error while deleting file"),e}}function re(){var l;(l=T.value)==null||l.click()}async function me(l){const e=l.target.files,d=[];for(let s=0;s<e.length;s++){const i=e.item(s),u=new FormData;u.append("file",i),d.push(C==null?void 0:C.post(u))}await Promise.all(d).then(s=>{a.value.filesHeader=[...a.value.filesHeader,...s.reduce((i,u,H)=>(i.push({id:u.data,file:e.item(H)}),i),[])]}).then(()=>{p.value=[...p.value,...l.target.files]})}function ce(l){try{l.id?(a.value.removedFilesHeader=[...a.value.removedFilesHeader,l.id],p.value=p.value.filter(e=>{var d;return((d=e==null?void 0:e.id)!=null?d:0)!==l.id})):(p.value=p.value.filter(e=>e!==l),a.value.files=a.value.files.filter(e=>e.file!==l))}catch(e){throw console.log("Error while deleting file"),e}}function U(l){const e=["0","1","2","3","4","5","6","7","8","9","."],d=l.key;e.includes(d)||l.preventDefault()}function Z(l,e="detail"){e==="detail"?f.value=l.map(d=>({...d,name:d.original_name})):e==="header"&&(p.value=l.map(d=>({...d,name:d.original_name})))}function A(l="detail"){let e=[];return l==="detail"?e=[...f.value]:l==="header"&&(e=[...p.value]),e.reduce((s,i,u)=>{const H=!i.id,h=u+1;let k=[];return l==="detail"?k=[...a.value.files]:l==="header"&&(k=[...a.value.filesHeader]),H?s.push({newImage:!0,order:h,id:k.find(P=>P.file===i).id}):s.push({newImage:!1,order:h,id:i.id}),s},[])}function ee(l){return URL.createObjectURL(l)}return(l,e)=>{const d=r("v-icon"),s=r("v-card-title"),i=r("v-col"),u=r("v-text-field"),H=r("v-autocomplete"),h=r("v-row"),k=r("v-textarea"),P=r("v-checkbox"),$=r("v-btn"),le=r("v-chip"),_e=r("v-container"),fe=r("v-form"),ve=r("v-card-text"),pe=r("v-spacer"),he=r("v-card-actions"),ge=r("v-card"),ye=r("v-dialog");return c(),D($,{variant:v(S).variant,size:v(S).size,color:v(S).color,onClick:ie},{default:o(()=>[w(B(x.mode==="create"?"Add New":"")+" ",1),x.mode!=="create"?(c(),D(d,{key:0,icon:v(S).icon},null,8,["icon"])):Fe("",!0),t(ye,{modelValue:q.value,"onUpdate:modelValue":e[16]||(e[16]=n=>q.value=n),activator:"parent","max-width":"800"},{default:o(()=>[t(ge,null,{default:o(()=>[t(s,null,{default:o(()=>[w(" Form ")]),_:1}),t(ve,null,{default:o(()=>[t(fe,{ref_key:"formProduct",ref:G},{default:o(()=>[t(_e,null,{default:o(()=>[t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[Ie]),_:1}),t(i,{md:"6"},{default:o(()=>[t(u,{modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>a.value.name=n),rules:_.value.name,label:"Product Name"},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"6"},{default:o(()=>[t(H,{modelValue:N.value,"onUpdate:modelValue":e[1]||(e[1]=n=>N.value=n),rules:_.value.category_id,items:v(L),label:"Category","item-title":"name","return-object":""},null,8,["modelValue","rules","items"])]),_:1}),t(i,{md:"6"},{default:o(()=>[t(u,{modelValue:a.value.code,"onUpdate:modelValue":e[2]||(e[2]=n=>a.value.code=n),rules:_.value.code,label:"Code"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[t(k,{modelValue:a.value.en_description,"onUpdate:modelValue":e[3]||(e[3]=n=>a.value.en_description=n),rules:_.value.en_description,label:"Description (English)",counter:""},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"12"},{default:o(()=>[t(k,{modelValue:a.value.id_description,"onUpdate:modelValue":e[4]||(e[4]=n=>a.value.id_description=n),rules:_.value.id_description,label:"Description (Bahasa)",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[t(k,{modelValue:a.value.features,"onUpdate:modelValue":e[5]||(e[5]=n=>a.value.features=n),rules:_.value.features,label:"Features",counter:""},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"12"},{default:o(()=>[t(k,{modelValue:a.value.premium_material,"onUpdate:modelValue":e[6]||(e[6]=n=>a.value.premium_material=n),rules:_.value.premium_material,label:"Premium Material",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[Ne]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.dimension_width,"onUpdate:modelValue":e[7]||(e[7]=n=>a.value.dimension_width=n),modelModifiers:{number:!0},rules:_.value.dimension_width,onKeypress:U,label:"Width"},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.dimension_length,"onUpdate:modelValue":e[8]||(e[8]=n=>a.value.dimension_length=n),modelModifiers:{number:!0},rules:_.value.dimension_length,onKeypress:U,label:"Length"},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.dimension_height,"onUpdate:modelValue":e[9]||(e[9]=n=>a.value.dimension_height=n),modelModifiers:{number:!0},rules:_.value.dimension_height,onKeypress:U,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[Se]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.seat_width,"onUpdate:modelValue":e[10]||(e[10]=n=>a.value.seat_width=n),modelModifiers:{number:!0},rules:_.value.seat_width,onKeypress:U,label:"Width"},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.seat_length,"onUpdate:modelValue":e[11]||(e[11]=n=>a.value.seat_length=n),modelModifiers:{number:!0},rules:_.value.seat_length,onKeypress:U,label:"Length"},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"4"},{default:o(()=>[t(u,{modelValue:a.value.seat_height,"onUpdate:modelValue":e[12]||(e[12]=n=>a.value.seat_height=n),modelModifiers:{number:!0},rules:_.value.seat_height,onKeypress:U,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(h,{class:"d-flex justify-center"},{default:o(()=>[t(i,{md:"12"},{default:o(()=>[je]),_:1}),(c(!0),y(R,null,O(v(J),n=>(c(),D(i,{md:"3",key:n.id},{default:o(()=>[m("div",De,[m("label",{for:`feature-${n.id}`},[m("img",{src:`${v(M)}${n.link}`},null,8,Ee)],8,Be),t(P,{id:`feature-${n.id}`,modelValue:a.value.feature_ids,"onUpdate:modelValue":e[13]||(e[13]=I=>a.value.feature_ids=I),value:n.id,class:"checkbox"},null,8,["id","modelValue","value"]),m("div",Ke,B(n.name),1)])]),_:2},1024))),128))]),_:1}),t(h,null,{default:o(()=>[t(i,{md:"12"},{default:o(()=>[Me]),_:1}),t(i,{md:"3",style:{height:"40px"}},{default:o(()=>[t($,{onClick:e[14]||(e[14]=n=>re())},{default:o(()=>[w(" Add Image ")]),_:1}),m("input",{ref_key:"fileHeader",ref:T,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:me},null,544)]),_:1}),t(i,{md:"12",class:"files"},{default:o(()=>[t(v(te),{list:p.value},{default:o(()=>[(c(!0),y(R,null,O(p.value,(n,I)=>(c(),y("div",{index:I,class:"chip-container"},[t(le,{"prepend-icon":"mdi-file-image"},{default:o(()=>[w(B(l.$ellipsis(n.name,20))+" ",1),t(d,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:Ve=>ce(n)},null,8,["onClick"])]),_:2},1024),m("div",ze,[n.link?(c(),y("img",{key:0,src:`${v(M)}${n.link}`},null,8,Le)):(c(),y("img",{key:1,src:ee(n)},null,8,Pe))])],8,qe))),256))]),_:1},8,["list"])]),_:1}),t(i,{md:"12"},{default:o(()=>[Re]),_:1}),t(i,{md:"3",style:{height:"40px"}},{default:o(()=>[t($,{onClick:e[15]||(e[15]=n=>de())},{default:o(()=>[w(" Add Image ")]),_:1}),m("input",{ref_key:"file",ref:W,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:se},null,544)]),_:1}),t(i,{md:"12",class:"files"},{default:o(()=>[t(v(te),{list:f.value},{default:o(()=>[(c(!0),y(R,null,O(f.value,(n,I)=>(c(),y("div",{index:I,class:"chip-container"},[t(le,{"prepend-icon":"mdi-file-image"},{default:o(()=>[w(B(l.$ellipsis(n.name,20))+" ",1),t(d,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:Ve=>ue(n)},null,8,["onClick"])]),_:2},1024),m("div",We,[n.link?(c(),y("img",{key:0,src:`${v(M)}${n.link}`},null,8,Te)):(c(),y("img",{key:1,src:ee(n)},null,8,Ge))])],8,Oe))),256))]),_:1},8,["list"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),t(he,{class:"footer-form"},{default:o(()=>[t(pe),z.value?(c(),y("div",Je,Ze)):(c(),D($,{key:0,color:"primary",onClick:ne},{default:o(()=>[w("Save")]),_:1})),t($,{color:"orange",onClick:X},{default:o(()=>[w("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const tl=$e(Ae,[["__scopeId","data-v-fdae73bd"]]);export{tl as default};
