import{V as G}from"./vue-draggable-next.esm-bundler.dacac5ed.js";import{d as H,i as b,r as i,k as M,o as K,b as r,e as x,f as P,w as l,g as t,j as c,u as C,y as Q,m as W,n as X,F as Y,h as v,t as w}from"./index.3417068f.js";const Z=v("div",{class:"d-flex justify-space-between"}," Settings ",-1),I=v("h3",null,[v("strong",null,"Product")],-1),ee=v("hr",null,null,-1),te=v("h3",null,[v("strong",null,"Category Product")],-1),le=v("hr",null,null,-1),de=H({__name:"Setting",setup(ae){const h=b("categoriesAPI"),S=b("productsAPI"),f=b("settingsAPI"),U=i(["created_at","name","code"]),j=i(["ascending","descending"]),y=i("created_at"),g=i("ascending"),_=i(),d=i([]),m=i(),k=i([]),L=i([]),T=M(()=>k.value.filter(a=>a.category_id===_.value&&!p.value.find(e=>e.id===a.id)).map(a=>({...a,diplay_name:`${a.name}-${a.code}`}))),p=M({get:()=>{var a,e;return((e=(a=d.value)==null?void 0:a.find(o=>o.category_id===_.value))!=null?e:{list:[]}).list},set:a=>{const e=d.value.find(o=>o.category_id===_.value);e&&(e.list=a,d.value=d.value.filter(o=>o.category_id!==(e==null?void 0:e.category_id)),d.value.push(e))}});K(async()=>{await(S==null?void 0:S.get().then(a=>{k.value=[...a.data]})),await(h==null?void 0:h.get().then(a=>{L.value=[...a.data]})),await(f==null?void 0:f.get().then(a=>{O(a.data)}))});function D(){if(_.value&&m.value){const a={category_id:_.value,list:[m.value]};let e=d.value.find(o=>o.category_id===a.category_id);e?(e.list=[...e.list,m.value],d.value=d.value.filter(o=>o.category_id!==(e==null?void 0:e.category_id)),d.value.push(e)):d.value.push(a),m.value=void 0}}function J(a){const e=d.value.find(o=>o.category_id===_.value);e&&(e.list=e.list.filter(o=>o.id!==a),d.value=d.value.filter(o=>o.category_id!==(e==null?void 0:e.category_id)),d.value.push(e))}function N(a){let e={type:"",value:""};switch(a){case"product-sort":e={type:a,value:{sortBy:y.value,sortMethod:g.value}};break;case"product-category":e={type:a,value:d.value.map(o=>({...o,list:o.list.map(s=>s.id)})).filter(o=>o.list.length>0)};break}!!e.type&&!!e.value&&(e.value=JSON.stringify(e.value),f==null||f.post(e))}function O(a){a.forEach(e=>{e.type==="product-sort"?E(e):e.type==="product-category"&&F(e)})}function E(a){const e=JSON.parse(a.value);g.value=e.sortMethod,y.value=e.sortBy}function F(a){const e=JSON.parse(a.value);d.value=e.map(o=>({category_id:o.category_id,list:k.value.filter(s=>o.list.includes(s.id))}))}return(a,e)=>{const o=r("v-card-title"),u=r("v-col"),s=r("v-row"),V=r("v-autocomplete"),B=r("v-btn"),R=r("v-icon"),q=r("v-chip"),$=r("v-container"),z=r("v-card-text"),A=r("v-card");return x(),P($,null,{default:l(()=>[t(s,null,{default:l(()=>[t(u,null,{default:l(()=>[t(A,null,{default:l(()=>[t(o,null,{default:l(()=>[Z]),_:1}),t(z,null,{default:l(()=>[t($,null,{default:l(()=>[t(s,{class:"my-3"},{default:l(()=>[I,t(u,null,{default:l(()=>[ee]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"},{default:l(()=>[c(" Sort By: ")]),_:1}),t(u,{md:"5"},{default:l(()=>[t(V,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=n=>y.value=n),items:U.value},null,8,["modelValue","items"])]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"},{default:l(()=>[c(" Sort method: ")]),_:1}),t(u,{md:"5"},{default:l(()=>[t(V,{modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=n=>g.value=n),items:j.value},null,8,["modelValue","items"])]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"}),t(u,{md:"5"},{default:l(()=>[t(B,{onClick:e[2]||(e[2]=n=>N("product-sort"))},{default:l(()=>[c(" Save ")]),_:1})]),_:1})]),_:1}),t(s,{class:"my-3"},{default:l(()=>[te,t(u,null,{default:l(()=>[le]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"},{default:l(()=>[c(" Category: ")]),_:1}),t(u,{md:"5"},{default:l(()=>[t(V,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=n=>_.value=n),items:L.value,"item-value":"id","item-title":"name"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"},{default:l(()=>[c(" Add Product: ")]),_:1}),t(u,{md:"5",class:"d-flex align-center"},{default:l(()=>[t(V,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=n=>m.value=n),items:C(T),"item-title":"display_name","return-object":""},null,8,["modelValue","items"]),t(B,{onClick:e[5]||(e[5]=n=>D())},{default:l(()=>[c(" Add ")]),_:1})]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"},{default:l(()=>[c(" List Product: ")]),_:1}),t(u,{md:"5"},{default:l(()=>[t(C(G),{modelValue:C(p),"onUpdate:modelValue":e[6]||(e[6]=n=>Q(p)?p.value=n:null)},{default:l(()=>[(x(!0),W(Y,null,X(C(p),n=>(x(),P(q,{style:{margin:"5px 0"},key:n.id,closable:"",color:"cyan",label:"","data-id":n.id,"onClick:close":oe=>J(n.id)},{default:l(()=>[t(R,{start:"",icon:"mdi-table-chair"}),c(" "+w(n.name)+" - "+w(n.code)+" ## "+w(n.id),1)]),_:2},1032,["data-id","onClick:close"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(s,null,{default:l(()=>[t(u,{md:"2"}),t(u,{md:"5"},{default:l(()=>[t(B,{onClick:e[7]||(e[7]=n=>N("product-category"))},{default:l(()=>[c(" Save ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{de as default};
