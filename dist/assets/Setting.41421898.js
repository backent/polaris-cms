import{V as I}from"./vue-draggable-next.esm-bundler.3b0f77fd.js";import{d as Z,i as D,r as p,k as K,x as ae,b as a,e as w,f as M,w as l,j as v,t as z,u as C,y as ue,g as t,z as de,A as se,h as f,l as Y,o as ce,B as ie,m as ee,F as te}from"./index.df3397a2.js";const re=["src"],_e={key:1,class:"lds-facebook"},ve=f("div",null,null,-1),me=f("div",null,null,-1),fe=f("div",null,null,-1),pe=[ve,me,fe],le=Z({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(O,{emit:U}){const k=O,y=D("tempMediaAPI"),r=D("featuresAPI"),j=p(!1),F=p(!1),J={name:"",order:99,temp_id:0},m=p(J),S=p(null),g=p(null),s=p(),h=K(()=>{const c={variant:void 0,icon:void 0,size:void 0,color:"primary"},_={variant:"plain",icon:k.icon,size:"x-small",color:k.colorButton};return k.mode==="create"?c:_}),x=K(()=>s.value?W(s.value):m.value.link?m.value.link:"");function N(){U("close"),j.value=!1}async function $(){const c=await P();if(!(c!=null&&c.valid))return;let _;const V={...m.value};return delete V.link,delete V.created_at,delete V.updated_at,F.value=!0,k.mode==="create"?_=r==null?void 0:r.post(V):_=r==null?void 0:r.put(m.value.id,V),_==null?void 0:_.then(()=>{N()}).catch(b=>{throw b}).finally(()=>{F.value=!1})}async function P(){var c;return(c=g.value)==null?void 0:c.validate()}ae(m,P,{deep:!0});function B(){m.value={...J},k.mode!=="create"&&(r==null||r.show(k.id).then(c=>{m.value={...c.data}}))}function R(){var c;(c=S.value)==null||c.click()}async function Q(c){const _=c.target.files,V=[];for(let b=0;b<_.length;b++){const q=_.item(b),o=new FormData;o.append("file",q),V.push(y==null?void 0:y.post(o))}await Promise.all(V).then(([b])=>{m.value.temp_id=b.data,s.value=_[0]})}function W(c){return c?URL.createObjectURL(c):""}return(c,_)=>{const V=a("v-icon"),b=a("v-card-title"),q=a("v-text-field"),o=a("v-col"),e=a("v-row"),n=a("v-btn"),d=a("v-container"),i=a("v-form"),L=a("v-card-text"),T=a("v-spacer"),H=a("v-card-actions"),X=a("v-card"),G=a("v-dialog");return w(),M(n,{variant:C(h).variant,size:C(h).size,color:C(h).color,onClick:B},{default:l(()=>[v(z(O.mode==="create"?"Add":"")+" ",1),O.mode!=="create"?(w(),M(V,{key:0,icon:C(h).icon},null,8,["icon"])):ue("",!0),t(G,{modelValue:j.value,"onUpdate:modelValue":_[2]||(_[2]=E=>j.value=E),activator:"parent","max-width":"600"},{default:l(()=>[t(X,null,{default:l(()=>[t(b,null,{default:l(()=>[v(" Form ")]),_:1}),t(L,null,{default:l(()=>[t(i,{ref_key:"formFeature",ref:g},{default:l(()=>[t(d,null,{default:l(()=>[t(e,null,{default:l(()=>[t(o,{md:"12"},{default:l(()=>[t(q,{modelValue:m.value.name,"onUpdate:modelValue":_[0]||(_[0]=E=>m.value.name=E),label:"Name"},null,8,["modelValue"])]),_:1})]),_:1}),de(t(e,{class:"d-flex justify-center"},{default:l(()=>[t(o,{md:"10",class:"d-flex justify-center"},{default:l(()=>[f("img",{class:"img-display",src:C(x),alt:""},null,8,re)]),_:1})]),_:1},512),[[se,C(x)]]),t(e,{class:"d-flex justify-center"},{default:l(()=>[t(o,{md:"10",class:"d-flex justify-center"},{default:l(()=>[t(n,{onClick:_[1]||(_[1]=E=>R())},{default:l(()=>[v(z(C(x)?"Update Image":"Add Image"),1)]),_:1}),f("input",{ref_key:"file",ref:S,type:"file",accept:".png,.jpg,.jpeg",style:{position:"absolute",visibility:"hidden"},onInput:Q},null,544)]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),t(H,{class:"footer-form"},{default:l(()=>[t(T),F.value?(w(),Y("div",_e,pe)):(w(),M(n,{key:0,color:"primary",onClick:$},{default:l(()=>[v("Save")]),_:1})),t(n,{color:"orange",onClick:N},{default:l(()=>[v("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const ye=Z({__name:"Delete",props:{id:{type:Number,default:0}},emits:["close"],setup(O,{emit:U}){const k=O,y=D("featuresAPI"),r=p(!1);function j(){return y==null?void 0:y.delete(k.id).then(()=>{F()})}function F(){U("close"),r.value=!1}return(J,m)=>{const S=a("v-icon"),g=a("v-card-title"),s=a("v-card-text"),h=a("v-spacer"),x=a("v-btn"),N=a("v-card-actions"),$=a("v-card"),P=a("v-dialog");return w(),M(x,{variant:"text",size:"x-small",color:"red"},{default:l(()=>[t(S,{icon:"mdi-trash-can-outline"}),t(P,{modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=B=>r.value=B),activator:"parent","max-width":"400"},{default:l(()=>[t($,null,{default:l(()=>[t(g,null,{default:l(()=>[v(" Remove ")]),_:1}),t(s,null,{default:l(()=>[v(" Are you sure want to remove this item ? ")]),_:1}),t(N,null,{default:l(()=>[t(h),t(x,{color:"primary",onClick:j},{default:l(()=>[v("Remove")]),_:1}),t(x,{color:"orange",onClick:F},{default:l(()=>[v("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),ge=f("div",{class:"d-flex justify-space-between"}," Settings ",-1),he=f("h3",null,[f("strong",null,"Product")],-1),Ce=f("hr",null,null,-1),ke=f("h3",null,[f("strong",null,"Category Product")],-1),Ve=f("hr",null,null,-1),xe=f("h3",null,[f("strong",null,"Product Features")],-1),be=f("hr",null,null,-1),we=["src"],Se={class:"number-feature"},$e={class:"name-feature"},Ue=Z({__name:"Setting",setup(O){const U=D("categoriesAPI"),k=D("productsAPI"),y=D("settingsAPI"),r=D("featuresAPI"),j=p(["created_at","name","code"]),F="https://polarisfurniture.id",J=p(["ascending","descending"]),m=p("created_at"),S=p("ascending"),g=p(),s=p([]),h=p(),x=p([]),N=p([]),$=p([]),P=K(()=>x.value.filter(o=>o.category_id===g.value&&!B.value.find(e=>e.id===o.id)).map(o=>({...o,diplay_name:`${o.name}-${o.code}`}))),B=K({get:()=>{var o,e;return((e=(o=s.value)==null?void 0:o.find(n=>n.category_id===g.value))!=null?e:{list:[]}).list},set:o=>{const e=s.value.find(n=>n.category_id===g.value);e&&(e.list=o,s.value=s.value.filter(n=>n.category_id!==(e==null?void 0:e.category_id)),s.value.push(e))}});ce(async()=>{R(),await(k==null?void 0:k.get().then(o=>{x.value=[...o.data]})),await(U==null?void 0:U.get().then(o=>{N.value=[...o.data]})),await(y==null?void 0:y.get().then(o=>{_(o.data)}))});async function R(){return r==null?void 0:r.get().then(o=>{$.value=[...o.data]})}function Q(){if(g.value&&h.value){const o={category_id:g.value,list:[h.value]};let e=s.value.find(n=>n.category_id===o.category_id);e?(e.list=[...e.list,h.value],s.value=s.value.filter(n=>n.category_id!==(e==null?void 0:e.category_id)),s.value.push(e)):s.value.push(o),h.value=void 0}}function W(o){const e=s.value.find(n=>n.category_id===g.value);e&&(e.list=e.list.filter(n=>n.id!==o),s.value=s.value.filter(n=>n.category_id!==(e==null?void 0:e.category_id)),s.value.push(e))}function c(o){let e={type:"",value:""};switch(o){case"product-sort":e={type:o,value:{sortBy:m.value,sortMethod:S.value}};break;case"product-category":e={type:o,value:s.value.map(n=>({...n,list:n.list.map(i=>i.id)})).filter(n=>n.list.length>0)};break}!!e.type&&!!e.value&&(e.value=JSON.stringify(e.value),y==null||y.post(e))}function _(o){o.forEach(e=>{e.type==="product-sort"?V(e):e.type==="product-category"&&b(e)})}function V(o){const e=JSON.parse(o.value);S.value=e.sortMethod,m.value=e.sortBy}function b(o){const e=JSON.parse(o.value);s.value=e.map(n=>({category_id:n.category_id,list:x.value.filter(i=>n.list.includes(i.id))}))}async function q(){const o=$.value.reduce((e,n,d)=>{n.order=d+1;const{link:i,created_at:L,updated_at:T,...H}=n;return e.push(H),e},[]);await Promise.all(o.map(e=>r==null?void 0:r.put(e.id,e)))}return(o,e)=>{const n=a("v-card-title"),d=a("v-col"),i=a("v-row"),L=a("v-autocomplete"),T=a("v-btn"),H=a("v-icon"),X=a("v-chip"),G=a("v-container"),E=a("v-card-text"),oe=a("v-card");return w(),M(G,null,{default:l(()=>[t(i,null,{default:l(()=>[t(d,null,{default:l(()=>[t(oe,null,{default:l(()=>[t(n,null,{default:l(()=>[ge]),_:1}),t(E,null,{default:l(()=>[t(G,null,{default:l(()=>[t(i,{class:"my-3"},{default:l(()=>[he,t(d,null,{default:l(()=>[Ce]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" Sort By: ")]),_:1}),t(d,{md:"5"},{default:l(()=>[t(L,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=u=>m.value=u),items:j.value},null,8,["modelValue","items"])]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" Sort method: ")]),_:1}),t(d,{md:"5"},{default:l(()=>[t(L,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=u=>S.value=u),items:J.value},null,8,["modelValue","items"])]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"}),t(d,{md:"5"},{default:l(()=>[t(T,{onClick:e[2]||(e[2]=u=>c("product-sort"))},{default:l(()=>[v(" Save ")]),_:1})]),_:1})]),_:1}),t(i,{class:"my-3"},{default:l(()=>[ke,t(d,null,{default:l(()=>[Ve]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" Category: ")]),_:1}),t(d,{md:"5"},{default:l(()=>[t(L,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=u=>g.value=u),items:N.value,"item-value":"id","item-title":"name"},null,8,["modelValue","items"])]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" Add Product: ")]),_:1}),t(d,{md:"5",class:"d-flex align-center"},{default:l(()=>[t(L,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=u=>h.value=u),items:C(P),"item-title":"display_name","return-object":""},null,8,["modelValue","items"]),t(T,{onClick:e[5]||(e[5]=u=>Q())},{default:l(()=>[v(" Add ")]),_:1})]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" List Product: ")]),_:1}),t(d,{md:"5"},{default:l(()=>[t(C(I),{modelValue:C(B),"onUpdate:modelValue":e[6]||(e[6]=u=>ie(B)?B.value=u:null)},{default:l(()=>[(w(!0),Y(te,null,ee(C(B),u=>(w(),M(X,{style:{margin:"5px 0"},key:u.id,closable:"",color:"cyan",label:"","data-id":u.id,"onClick:close":A=>W(u.id)},{default:l(()=>[t(H,{start:"",icon:"mdi-table-chair"}),v(" "+z(u.name)+" - "+z(u.code)+" ## "+z(u.id),1)]),_:2},1032,["data-id","onClick:close"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"}),t(d,{md:"5"},{default:l(()=>[t(T,{onClick:e[7]||(e[7]=u=>c("product-category"))},{default:l(()=>[v(" Save ")]),_:1})]),_:1})]),_:1}),t(i,{class:"my-3"},{default:l(()=>[xe,t(d,null,{default:l(()=>[be]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,null,{default:l(()=>[t(le,{onClose:e[8]||(e[8]=u=>R())})]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(d,{md:"2"},{default:l(()=>[v(" List Feature: ")]),_:1})]),_:1}),t(i,null,{default:l(()=>[t(C(I),{modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=u=>$.value=u),onChange:e[12]||(e[12]=u=>q()),class:"d-flex justify-center"},{default:l(()=>[(w(!0),Y(te,null,ee($.value,(u,A)=>(w(),M(d,{class:"container-feature-image",key:u.id,md:"2"},{default:l(()=>[f("img",{class:"feature-image",src:C(F)+u.link},null,8,we),f("div",Se," -"+z(A+1)+"- ",1),f("div",$e,z(u.name),1),t(ye,{id:u.id,class:"delete-feature",onClose:e[9]||(e[9]=ne=>R())},null,8,["id"]),t(le,{id:u.id,class:"edit-feature",mode:"edit",onClose:e[10]||(e[10]=ne=>R())},null,8,["id"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Ue as default};
