import{V as X}from"./vue-draggable-next.esm-bundler.01655422.js";import{d as Fe,i as E,r as p,x as Ce,E as He,k as $e,o as Ue,b as c,e as m,f as q,w as o,j as V,t as j,u as v,y as Ie,g as t,l as f,F as K,m as z,h as r,s as je,v as Ne,p as Se}from"./index.d1752c1d.js";const b=C=>(je("data-v-4a7efa26"),C=C(),Ne(),C),Be=b(()=>r("h3",null,"Details",-1)),Ee=b(()=>r("h3",null,"Dimension",-1)),qe=b(()=>r("h3",null,"Seat",-1)),Ke=b(()=>r("h3",null,"Features",-1)),ze={class:"feature-container"},Le=["for"],Me=["src"],Pe={class:"feature-name"},Re=b(()=>r("h3",null,"Image Header",-1)),Oe=["index"],We={class:"tooltip"},Te=["src"],Ge=["src"],Je=b(()=>r("h3",null,"Image Product",-1)),Qe=["index"],Xe={class:"tooltip"},Ye=["src"],Ze=["src"],Ae=b(()=>r("h3",null,"Image Dimension",-1)),el=["index"],ll={class:"tooltip"},tl=["src"],nl=["src"],il={key:1,class:"lds-facebook"},ol=b(()=>r("div",null,null,-1)),al=b(()=>r("div",null,null,-1)),sl=b(()=>r("div",null,null,-1)),ul=[ol,al,sl],dl=Fe({__name:"Form",props:{mode:{type:String,default:"create"},icon:{type:String,default:"mdi-pencil"},colorButton:{type:String,default:"orange"},id:{type:Number,default:0}},emits:["close"],setup(C,{emit:ae}){const $=C,L=E("categoriesAPI"),w=E("productsAPI"),x=E("tempMediaAPI"),M=E("featuresAPI"),N="https://polarisfurniture.id",P=p(!1),R=p(!1),Y=p(null),Z=p(null),A=p(null),ee=p(null),S=p();let O=[],le=[];const _=p({name:[l=>!!l||"Name is required!"],category_id:[l=>!!l||"Category is required!"],code:[],id_description:[],en_description:[],features:[],premium_material:[],dimension_height:[],dimension_length:[],dimension_width:[],seat_width:[],seat_height:[],seat_length:[]}),te={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],filesHeader:[],filesDimension:[],removedFiles:[],removedFilesHeader:[],removedFilesDimension:[],order:[],feature_ids:[]},n=p({...te}),h=p([]),g=p([]),y=p([]);function ne(){ae("close"),P.value=!1}async function ie(){var l;return(l=ee.value)==null?void 0:l.validate()}async function se(){const l=await ie();if(!(l!=null&&l.valid))return;let e;const s={...n.value,files:n.value.files.map(u=>u.id),filesHeader:n.value.filesHeader.map(u=>u.id),filesDimension:n.value.filesDimension.map(u=>u.id),order:T(),orderHeader:T("header"),orderDimension:T("header")};return R.value=!0,$.mode==="create"?e=w==null?void 0:w.post(s):e=w==null?void 0:w.put(n.value.id,s),e==null?void 0:e.then(()=>{ne()}).catch(u=>{throw u}).finally(()=>{R.value=!1})}Ce(n,ie,{deep:!0}),He(()=>{var l,e;n.value.category_id=(e=(l=S.value)==null?void 0:l.id)!=null?e:0});const B=$e(()=>{const l={variant:void 0,icon:void 0,size:void 0,color:"primary"},e={variant:"plain",icon:$.icon,size:"x-small",color:$.colorButton};return $.mode==="create"?l:e});Ue(()=>{L==null||L.get().then(l=>{O=l.data}),M==null||M.get().then(l=>{le=l.data})});function ue(){n.value={name:"",category_id:null,id_description:"",en_description:"",features:"",premium_material:"",dimension_height:0,dimension_length:0,seat_width:0,seat_height:0,seat_length:0,dimension_width:0,code:"",files:[],filesHeader:[],filesDimension:[],removedFiles:[],removedFilesHeader:[],removedFilesDimension:[],order:[],feature_ids:[]},h.value=[]}async function de(){ue(),$.mode!=="create"&&(w==null||w.show($.id).then(l=>{const{images:e,images_header:s,images_dimension:u,...a}=l.data;n.value={...te,...a},S.value=O.find(d=>d.id===n.value.category_id),W(e),W(s,"header"),W(u,"dimension")}))}function re(){var l;(l=Y.value)==null||l.click()}async function me(l){const e=l.target.files,s=[];for(let u=0;u<e.length;u++){const a=e.item(u),d=new FormData;d.append("file",a),s.push(x==null?void 0:x.post(d))}await Promise.all(s).then(u=>{n.value.files=[...n.value.files,...u.reduce((a,d,D)=>(a.push({id:d.data,file:e.item(D)}),a),[])]}).then(()=>{h.value=[...h.value,...l.target.files]})}function ce(l){try{l.id?(n.value.removedFiles=[...n.value.removedFiles,l.id],h.value=h.value.filter(e=>{var s;return((s=e==null?void 0:e.id)!=null?s:0)!==l.id})):(h.value=h.value.filter(e=>e!==l),n.value.files=n.value.files.filter(e=>e.file!==l))}catch(e){throw console.log("Error while deleting file"),e}}function fe(){var l;(l=Z.value)==null||l.click()}async function _e(l){const e=l.target.files,s=[];for(let u=0;u<e.length;u++){const a=e.item(u),d=new FormData;d.append("file",a),s.push(x==null?void 0:x.post(d))}await Promise.all(s).then(u=>{n.value.filesHeader=[...n.value.filesHeader,...u.reduce((a,d,D)=>(a.push({id:d.data,file:e.item(D)}),a),[])]}).then(()=>{g.value=[...g.value,...l.target.files]})}function ve(l){try{l.id?(n.value.removedFilesHeader=[...n.value.removedFilesHeader,l.id],g.value=g.value.filter(e=>{var s;return((s=e==null?void 0:e.id)!=null?s:0)!==l.id})):(g.value=g.value.filter(e=>e!==l),n.value.files=n.value.files.filter(e=>e.file!==l))}catch(e){throw console.log("Error while deleting file"),e}}function pe(){var l;(l=A.value)==null||l.click()}async function he(l){const e=l.target.files,s=[];for(let u=0;u<e.length;u++){const a=e.item(u),d=new FormData;d.append("file",a),s.push(x==null?void 0:x.post(d))}await Promise.all(s).then(u=>{n.value.filesDimension=[...n.value.filesDimension,...u.reduce((a,d,D)=>(a.push({id:d.data,file:e.item(D)}),a),[])]}).then(()=>{y.value=[...y.value,...l.target.files]})}function ge(l){try{l.id?(n.value.removedFilesDimension=[...n.value.removedFilesDimension,l.id],y.value=y.value.filter(e=>{var s;return((s=e==null?void 0:e.id)!=null?s:0)!==l.id})):(y.value=y.value.filter(e=>e!==l),n.value.files=n.value.files.filter(e=>e.file!==l))}catch(e){throw console.log("Error while deleting file"),e}}function U(l){const e=["0","1","2","3","4","5","6","7","8","9","."],s=l.key;e.includes(s)||l.preventDefault()}function W(l,e="detail"){e==="detail"?h.value=l.map(s=>({...s,name:s.original_name})):e==="header"?g.value=l.map(s=>({...s,name:s.original_name})):e==="dimension"&&(y.value=l.map(s=>({...s,name:s.original_name})))}function T(l="detail"){let e=[];return l==="detail"?e=[...h.value]:l==="header"?e=[...g.value]:l==="dimension"&&(e=[...y.value]),e.reduce((u,a,d)=>{const D=!a.id,k=d+1;let F=[];return l==="detail"?F=[...n.value.files]:l==="header"?F=[...n.value.filesHeader]:l==="dimension"&&(F=[...n.value.filesDimension]),D?u.push({newImage:!0,order:k,id:F.find(J=>J.file===a).id}):u.push({newImage:!1,order:k,id:a.id}),u},[])}function G(l){return URL.createObjectURL(l)}return(l,e)=>{const s=c("v-icon"),u=c("v-card-title"),a=c("v-col"),d=c("v-text-field"),D=c("v-autocomplete"),k=c("v-row"),F=c("v-textarea"),J=c("v-checkbox"),I=c("v-btn"),Q=c("v-chip"),ye=c("v-container"),ke=c("v-form"),Ve=c("v-card-text"),be=c("v-spacer"),we=c("v-card-actions"),xe=c("v-card"),De=c("v-dialog");return m(),q(I,{variant:v(B).variant,size:v(B).size,color:v(B).color,onClick:de},{default:o(()=>[V(j(C.mode==="create"?"Add New":"")+" ",1),C.mode!=="create"?(m(),q(s,{key:0,icon:v(B).icon},null,8,["icon"])):Ie("",!0),t(De,{modelValue:P.value,"onUpdate:modelValue":e[17]||(e[17]=i=>P.value=i),activator:"parent","max-width":"800"},{default:o(()=>[t(xe,null,{default:o(()=>[t(u,null,{default:o(()=>[V(" Form ")]),_:1}),t(Ve,null,{default:o(()=>[t(ke,{ref_key:"formProduct",ref:ee},{default:o(()=>[t(ye,null,{default:o(()=>[t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[Be]),_:1}),t(a,{md:"6"},{default:o(()=>[t(d,{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=i=>n.value.name=i),rules:_.value.name,label:"Product Name"},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"6"},{default:o(()=>[t(D,{modelValue:S.value,"onUpdate:modelValue":e[1]||(e[1]=i=>S.value=i),rules:_.value.category_id,items:v(O),label:"Category","item-title":"name","return-object":""},null,8,["modelValue","rules","items"])]),_:1}),t(a,{md:"6"},{default:o(()=>[t(d,{modelValue:n.value.code,"onUpdate:modelValue":e[2]||(e[2]=i=>n.value.code=i),rules:_.value.code,label:"Code"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[t(F,{modelValue:n.value.en_description,"onUpdate:modelValue":e[3]||(e[3]=i=>n.value.en_description=i),rules:_.value.en_description,label:"Description (English)",counter:""},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"12"},{default:o(()=>[t(F,{modelValue:n.value.id_description,"onUpdate:modelValue":e[4]||(e[4]=i=>n.value.id_description=i),rules:_.value.id_description,label:"Description (Bahasa)",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[t(F,{modelValue:n.value.features,"onUpdate:modelValue":e[5]||(e[5]=i=>n.value.features=i),rules:_.value.features,label:"Features",counter:""},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"12"},{default:o(()=>[t(F,{modelValue:n.value.premium_material,"onUpdate:modelValue":e[6]||(e[6]=i=>n.value.premium_material=i),rules:_.value.premium_material,label:"Premium Material",counter:""},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[Ee]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.dimension_width,"onUpdate:modelValue":e[7]||(e[7]=i=>n.value.dimension_width=i),modelModifiers:{number:!0},rules:_.value.dimension_width,onKeypress:U,label:"Width"},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.dimension_length,"onUpdate:modelValue":e[8]||(e[8]=i=>n.value.dimension_length=i),modelModifiers:{number:!0},rules:_.value.dimension_length,onKeypress:U,label:"Length"},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.dimension_height,"onUpdate:modelValue":e[9]||(e[9]=i=>n.value.dimension_height=i),modelModifiers:{number:!0},rules:_.value.dimension_height,onKeypress:U,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[qe]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.seat_width,"onUpdate:modelValue":e[10]||(e[10]=i=>n.value.seat_width=i),modelModifiers:{number:!0},rules:_.value.seat_width,onKeypress:U,label:"Width"},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.seat_length,"onUpdate:modelValue":e[11]||(e[11]=i=>n.value.seat_length=i),modelModifiers:{number:!0},rules:_.value.seat_length,onKeypress:U,label:"Length"},null,8,["modelValue","rules"])]),_:1}),t(a,{md:"4"},{default:o(()=>[t(d,{modelValue:n.value.seat_height,"onUpdate:modelValue":e[12]||(e[12]=i=>n.value.seat_height=i),modelModifiers:{number:!0},rules:_.value.seat_height,onKeypress:U,label:"Height"},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(k,{class:"d-flex justify-center"},{default:o(()=>[t(a,{md:"12"},{default:o(()=>[Ke]),_:1}),(m(!0),f(K,null,z(v(le),i=>(m(),q(a,{md:"3",key:i.id},{default:o(()=>[r("div",ze,[r("label",{for:`feature-${i.id}`},[r("img",{src:`${v(N)}${i.link}`},null,8,Me)],8,Le),t(J,{id:`feature-${i.id}`,modelValue:n.value.feature_ids,"onUpdate:modelValue":e[13]||(e[13]=H=>n.value.feature_ids=H),value:i.id,class:"checkbox"},null,8,["id","modelValue","value"]),r("div",Pe,j(i.name),1)])]),_:2},1024))),128))]),_:1}),t(k,null,{default:o(()=>[t(a,{md:"12"},{default:o(()=>[Re]),_:1}),t(a,{md:"3",style:{height:"40px"}},{default:o(()=>[t(I,{onClick:e[14]||(e[14]=i=>fe())},{default:o(()=>[V(" Add Image ")]),_:1}),r("input",{ref_key:"fileHeader",ref:Z,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:_e},null,544)]),_:1}),t(a,{md:"12",class:"files"},{default:o(()=>[t(v(X),{list:g.value},{default:o(()=>[(m(!0),f(K,null,z(g.value,(i,H)=>(m(),f("div",{index:H,class:"chip-container"},[t(Q,{"prepend-icon":"mdi-file-image"},{default:o(()=>[V(j(l.$ellipsis(i.name,20))+" ",1),t(s,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:oe=>ve(i)},null,8,["onClick"])]),_:2},1024),r("div",We,[i.link?(m(),f("img",{key:0,src:`${v(N)}${i.link}`},null,8,Te)):(m(),f("img",{key:1,src:G(i)},null,8,Ge))])],8,Oe))),256))]),_:1},8,["list"])]),_:1}),t(a,{md:"12"},{default:o(()=>[Je]),_:1}),t(a,{md:"3",style:{height:"40px"}},{default:o(()=>[t(I,{onClick:e[15]||(e[15]=i=>re())},{default:o(()=>[V(" Add Image ")]),_:1}),r("input",{ref_key:"file",ref:Y,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:me},null,544)]),_:1}),t(a,{md:"12",class:"files"},{default:o(()=>[t(v(X),{list:h.value},{default:o(()=>[(m(!0),f(K,null,z(h.value,(i,H)=>(m(),f("div",{index:H,class:"chip-container"},[t(Q,{"prepend-icon":"mdi-file-image"},{default:o(()=>[V(j(l.$ellipsis(i.name,20))+" ",1),t(s,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:oe=>ce(i)},null,8,["onClick"])]),_:2},1024),r("div",Xe,[i.link?(m(),f("img",{key:0,src:`${v(N)}${i.link}`},null,8,Ye)):(m(),f("img",{key:1,src:G(i)},null,8,Ze))])],8,Qe))),256))]),_:1},8,["list"])]),_:1}),t(a,{md:"12"},{default:o(()=>[Ae]),_:1}),t(a,{md:"3",style:{height:"40px"}},{default:o(()=>[t(I,{onClick:e[16]||(e[16]=i=>pe())},{default:o(()=>[V(" Add Image ")]),_:1}),r("input",{ref_key:"fileDimension",ref:A,type:"file",accept:".png,.jpg,.jpeg",multiple:"",style:{visibility:"hidden"},onInput:he},null,544)]),_:1}),t(a,{md:"12",class:"files"},{default:o(()=>[t(v(X),{list:y.value},{default:o(()=>[(m(!0),f(K,null,z(y.value,(i,H)=>(m(),f("div",{index:H,class:"chip-container"},[t(Q,{"prepend-icon":"mdi-file-image"},{default:o(()=>[V(j(l.$ellipsis(i.name,20))+" ",1),t(s,{icon:"mdi-trash-can-outline",color:"pink",style:{"margin-left":"5px"},onClick:oe=>ge(i)},null,8,["onClick"])]),_:2},1024),r("div",ll,[i.link?(m(),f("img",{key:0,src:`${v(N)}${i.link}`},null,8,tl)):(m(),f("img",{key:1,src:G(i)},null,8,nl))])],8,el))),256))]),_:1},8,["list"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1}),t(we,{class:"footer-form"},{default:o(()=>[t(be),R.value?(m(),f("div",il,ul)):(m(),q(I,{key:0,color:"primary",onClick:se},{default:o(()=>[V("Save")]),_:1})),t(I,{color:"orange",onClick:ne},{default:o(()=>[V("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["variant","size","color"])}}});const cl=Se(dl,[["__scopeId","data-v-4a7efa26"]]);export{cl as default};
